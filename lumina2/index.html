<!doctype html>
<!--[if lt IE 7 ]> <html lang="en" class="ie6"> <![endif]-->
<!--[if IE 7 ]>    <html lang="en" class="ie7"> <![endif]-->
<!--[if IE 8 ]>    <html lang="en" class="ie8"> <![endif]-->
<!--[if IE 9 ]>    <html lang="en" class="ie9"> <![endif]-->
<!--[if !IE]><!--> <html lang="en"> <!--<![endif]-->
<head>
<title>Lumina Hotels 2015!</title>
<meta name="viewport" content="width = 1050, user-scalable = no" />
<script type="text/javascript" src="../extras/jquery.min.1.7.js"></script>
<script type="text/javascript" src="../extras/modernizr.2.5.3.min.js"></script>
<script type="text/javascript" src="../lib/hash.js"></script>
<script type="text/javascript" src="../js/sweetalert.min.js"></script>
<script type="text/javascript" src="../js/jquery.mobile-1.4.5.min.js"></script>
<link rel="stylesheet" type="text/css" href="../css/sweetalert.css">


<!-- Start of Woopra Code -->
<script>
(function(){
        var t,i,e,n=window,o=document,a=arguments,s="script",r=["config","track","identify","visit","push","call","trackForm","trackClick"],c=function(){var t,i=this;for(i._e=[],t=0;r.length>t;t++)(function(t){i[t]=function(){return i._e.push([t].concat(Array.prototype.slice.call(arguments,0))),i}})(r[t])};for(n._w=n._w||{},t=0;a.length>t;t++)n._w[a[t]]=n[a[t]]=n[a[t]]||new c;i=o.createElement(s),i.async=1,i.src="//static.woopra.com/js/t/5.js",e=o.getElementsByTagName(s)[0],e.parentNode.insertBefore(i,e)
})("woopra");

woopra.config({
    domain: 'sushotel.github.io'
});
woopra.track();
</script>
<!-- End of Woopra Code -->


</head>
<body style="background-color: white">

<!--<audio autoplay loop>
    <source src="../audio/FrozenSilenceMeadow.mp3">
</audio> -->
<!-- <audio class="thumbnail" id="paparazzi" controls="none">
    <source src="FrozenSilenceMeadow.mp3" type="audio/mpeg" />
    Your browser does not support HTML5 audio.
</audio> -->


<div id="canvas">

<div class="zoom-icon zoom-icon-in"></div>

<div class="magazine-viewport">
	<div class="container">
		<div class="magazine">
			<!-- Next button -->
			<div ignore="1" class="next-button"></div>
			<!-- Previous button -->
			<div ignore="1" class="previous-button"></div>
		</div>
	</div>
</div>

<!-- Thumbnails -->
<div class="thumbnails">
	<div>
		<ul>
			<li class="i">
				<img src="pages/1-thumb.jpg" width="76" height="100" class="page-1">
				<span>1</span>
			</li>
			<li class="d">
				<img src="pages/2-thumb.jpg" width="76" height="100" class="page-2">
				<img src="pages/3-thumb.jpg" width="76" height="100" class="page-3">
				<span>2-3</span>
			</li>
			<li class="d">
				<img src="pages/4-thumb.jpg" width="76" height="100" class="page-4">
				<img src="pages/5-thumb.jpg" width="76" height="100" class="page-5">
				<span>4-5</span>
			</li>
			<li class="d">
				<img src="pages/6-thumb.jpg" width="76" height="100" class="page-6">
				<img src="pages/7-thumb.jpg" width="76" height="100" class="page-7">
				<span>6-7</span>
			</li>
			<li class="d">
				<img src="pages/8-thumb.jpg" width="76" height="100" class="page-8">
				<img src="pages/9-thumb.jpg" width="76" height="100" class="page-9">
				<span>8-9</span>
			</li>
			<li class="d">
				<img src="pages/10-thumb.jpg" width="76" height="100" class="page-10">
				<img src="pages/11-thumb.jpg" width="76" height="100" class="page-11">
				<span>10-11</span>
			</li>
			<li class="d">
				<img src="pages/12-thumb.jpg" width="76" height="100" class="page-12">
				<img src="pages/13-thumb.jpg" width="76" height="100" class="page-13">
				<span>12-13</span>
			</li>
			<li class="d">
				<img src="pages/14-thumb.jpg" width="76" height="100" class="page-14">
				<img src="pages/15-thumb.jpg" width="76" height="100" class="page-15">
				<span>14-15</span>
			</li>
			<li class="d">
				<img src="pages/16-thumb.jpg" width="76" height="100" class="page-16">
				<img src="pages/17-thumb.jpg" width="76" height="100" class="page-17">
				<span>16-17</span>
			</li>
			<li class="d">
				<img src="pages/18-thumb.jpg" width="76" height="100" class="page-18">
				<img src="pages/19-thumb.jpg" width="76" height="100" class="page-19">
				<span>18-19</span>
			</li>
			<li class="d">
				<img src="pages/20-thumb.jpg" width="76" height="100" class="page-20">
				<img src="pages/21-thumb.jpg" width="76" height="100" class="page-21">
				<span>20-21</span>
			</li>
			<li class="d">
				<img src="pages/22-thumb.jpg" width="76" height="100" class="page-22">
				<img src="pages/23-thumb.jpg" width="76" height="100" class="page-23">
				<span>22-23</span>
			</li>
			<li class="d">
				<img src="pages/24-thumb.jpg" width="76" height="100" class="page-24">
				<img src="pages/25-thumb.jpg" width="76" height="100" class="page-25">
				<span>24-25</span>
			</li>
			<li class="d">
				<img src="pages/26-thumb.jpg" width="76" height="100" class="page-26">
				<img src="pages/27-thumb.jpg" width="76" height="100" class="page-27">
				<span>26-27</span>
			</li>
			<li class="d">
				<img src="pages/28-thumb.jpg" width="76" height="100" class="page-28">
				<img src="pages/29-thumb.jpg" width="76" height="100" class="page-29">
				<span>28-29</span>
			</li>
			<li class="i">
				<img src="pages/30-thumb.jpg" width="76" height="100" class="page-30">
				<span>30</span>
			</li>
		<ul>
	<div>	
</div>
</div>

<script type="text/javascript">

var lastPage = false;
var time_then = Date.now();
var previousPage = 1;

function loadApp() {

 	$('#canvas').fadeIn(1000);

 	var flipbook = $('.magazine');

 	// Check if the CSS was already loaded
	
	if (flipbook.width()==0 || flipbook.height()==0) {
		setTimeout(loadApp, 10);
		return;
	}
	
	// Create the flipbook

	flipbook.turn({
			
			// Magazine width

			width: 922,

			// Magazine height

			height: 600,

			// Duration in millisecond

			duration: 1000,

			// Hardware acceleration

			acceleration: !isChrome(),

			// Enables gradients

			gradients: true,
			
			// Auto center this flipbook

			autoCenter: true,

			// Elevation from the edge of the flipbook when turning a page

			elevation: 50,

			// The number of pages

			pages: 30,

			// Events

			when: {
				turning: function(event, page, view) {
					
					var book = $(this),
					currentPage = book.turn('page'),
					pages = book.turn('pages');
			
					// Update the current URI

					Hash.go('page/' + page).update();

					// Show and hide navigation buttons

					disableControls(page);

					//tracking code
					woopra.track();
					
					var time_now = Date.now();
					var vt = (time_now - time_then)/1000;
					var rt = ((time_now - time_then)-current_idleTime)/1000;
					if (rt < 0) {
						rt = vt;
					}
					woopra.track("read", {
						page_no: previousPage,
						viewing_time: vt,
						reading_time: Math.abs(rt)
						
					});
					previousPage = page;
					current_idleTime = 0;
					idleTime_clone = 0;
					time_then = Date.now();

					idleTime =0;
					if (page ==30) {
						lastPage = true;
					}
					//-------------------------

					$('.thumbnails .page-'+currentPage).
						parent().
						removeClass('current');

					$('.thumbnails .page-'+page).
						parent().
						addClass('current');



				},

				turned: function(event, page, view) {

					disableControls(page);

					$(this).turn('center');

					if (page==1) { 
						$(this).turn('peel', 'br');
					}

				},

				missing: function (event, pages) {

					// Add pages that aren't in the magazine

					for (var i = 0; i < pages.length; i++)
						addPage(pages[i], $(this));

				}
			}

	});

	// Zoom.js

	$('.magazine-viewport').zoom({
		flipbook: $('.magazine'),

		max: function() { 
			
			return largeMagazineWidth()/$('.magazine').width();

		}, 

		when: {

			swipeLeft: function() {

				$(this).zoom('flipbook').turn('next');

			},

			swipeRight: function() {
				
				$(this).zoom('flipbook').turn('previous');

			},

			resize: function(event, scale, page, pageElement) {

				if (scale==1)
					loadSmallPage(page, pageElement);
				else
					loadLargePage(page, pageElement);

			},

			zoomIn: function () {

				$('.thumbnails').hide();
				$('.made').hide();
				$('.magazine').removeClass('animated').addClass('zoom-in');
				$('.zoom-icon').removeClass('zoom-icon-in').addClass('zoom-icon-out');
				
				if (!window.escTip && !$.isTouch) {
					escTip = true;

					$('<div />', {'class': 'exit-message'}).
						html('<div>Press ESC to exit</div>').
							appendTo($('body')).
							delay(2000).
							animate({opacity:0}, 500, function() {
								$(this).remove();
							});
				}
			},

			zoomOut: function () {

				$('.exit-message').hide();
				$('.thumbnails').fadeIn();
				$('.made').fadeIn();
				$('.zoom-icon').removeClass('zoom-icon-out').addClass('zoom-icon-in');

				setTimeout(function(){
					$('.magazine').addClass('animated').removeClass('zoom-in');
					resizeViewport();
				}, 0);

			}
		}
	});

	// Zoom event

	if ($.isTouch)
		$('.magazine-viewport').bind('zoom.doubleTap', zoomTo);
	else
		$('.magazine-viewport').bind('zoom.tap', zoomTo);


	// Using arrow keys to turn the page

	$(document).keydown(function(e){

		var previous = 37, next = 39, esc = 27;

		switch (e.keyCode) {
			case previous:

				// left arrow
				$('.magazine').turn('previous');
				e.preventDefault();

			break;
			case next:

				//right arrow
				$('.magazine').turn('next');
				e.preventDefault();

			break;
			case esc:
				
				$('.magazine-viewport').zoom('zoomOut');	
				e.preventDefault();

			break;
		}
	});

	// URIs - Format #/page/1 

	Hash.on('^page\/([0-9]*)$', {
		yep: function(path, parts) {
			var page = parts[1];

			if (page!==undefined) {
				if ($('.magazine').turn('is'))
					$('.magazine').turn('page', page);
			}

		},
		nop: function(path) {

			if ($('.magazine').turn('is'))
				$('.magazine').turn('page', 1);
		}
	});


	$(window).resize(function() {
		resizeViewport();
	}).bind('orientationchange', function() {
		resizeViewport();
	});

	// Events for thumbnails

	$('.thumbnails').click(function(event) {
		
		var page;

		if (event.target && (page=/page-([0-9]+)/.exec($(event.target).attr('class'))) ) {
		
			$('.magazine').turn('page', page[1]);
		}
	});

	$('.thumbnails li').
		bind($.mouseEvents.over, function() {
			
			$(this).addClass('thumb-hover');

		}).bind($.mouseEvents.out, function() {
			
			$(this).removeClass('thumb-hover');

		});

	if ($.isTouch) {
	
		$('.thumbnails').
			addClass('thumbanils-touch').
			bind($.mouseEvents.move, function(event) {
				event.preventDefault();
			});

	} else {

		$('.thumbnails ul').mouseover(function() {

			$('.thumbnails').addClass('thumbnails-hover');

		}).mousedown(function() {

			return false;

		}).mouseout(function() {

			$('.thumbnails').removeClass('thumbnails-hover');

		});

	}


	// Regions

	if ($.isTouch) {
		$('.magazine').bind('touchstart', regionClick);
	} else {
		$('.magazine').click(regionClick);
	}

	// Events for the next button

	$('.next-button').bind($.mouseEvents.over, function() {
		
		$(this).addClass('next-button-hover');

	}).bind($.mouseEvents.out, function() {
		
		$(this).removeClass('next-button-hover');

	}).bind($.mouseEvents.down, function() {
		
		$(this).addClass('next-button-down');

	}).bind($.mouseEvents.up, function() {
		
		$(this).removeClass('next-button-down');

	}).click(function() {
		
		$('.magazine').turn('next');

	});

	// Events for the next button
	
	$('.previous-button').bind($.mouseEvents.over, function() {
		
		$(this).addClass('previous-button-hover');

	}).bind($.mouseEvents.out, function() {
		
		$(this).removeClass('previous-button-hover');

	}).bind($.mouseEvents.down, function() {
		
		$(this).addClass('previous-button-down');

	}).bind($.mouseEvents.up, function() {
		
		$(this).removeClass('previous-button-down');

	}).click(function() {
		
		$('.magazine').turn('previous');

	});


	resizeViewport();

	$('.magazine').addClass('animated');

}

// Zoom icon

 $('.zoom-icon').bind('mouseover', function() { 
 	
 	if ($(this).hasClass('zoom-icon-in'))
 		$(this).addClass('zoom-icon-in-hover');

 	if ($(this).hasClass('zoom-icon-out'))
 		$(this).addClass('zoom-icon-out-hover');
 
 }).bind('mouseout', function() { 
 	
 	 if ($(this).hasClass('zoom-icon-in'))
 		$(this).removeClass('zoom-icon-in-hover');
 	
 	if ($(this).hasClass('zoom-icon-out'))
 		$(this).removeClass('zoom-icon-out-hover');

 }).bind('click', function() {

 	if ($(this).hasClass('zoom-icon-in'))
 		$('.magazine-viewport').zoom('zoomIn');
 	else if ($(this).hasClass('zoom-icon-out'))	
		$('.magazine-viewport').zoom('zoomOut');

 });

 $('#canvas').hide();


// Load the HTML4 version if there's not CSS transform

yepnope({
	test : Modernizr.csstransforms,
	yep: ['lib/turn.js'],
	nope: ['lib/turn.html4.min.js'],
	both: ['lib/zoom.min.js', 'js/magazine.js', 'css/magazine.css'],
	complete: loadApp
});

</script>

<script type="text/javascript">
// alert box
var user_id = "undefined";
//read URL parameters from query string
var queryString = (function(a) {
    if (a == "") return {};
    var b = {};
    for (var i = 0; i < a.length; ++i)
    {
        var p=a[i].split('=', 2);
        if (p.length == 1)
            b[p[0]] = "";
        else
            b[p[0]] = decodeURIComponent(p[1].replace(/\+/g, " "));
    }
    return b;
})(window.location.search.substr(1).split('&'));
user_id = queryString["tic"];
var tic_time = new Date();
woopra.track("ticID", {
			    timestamp: tic_time.toUTCString(),
			    tic: user_id
			});

//-------------------------
var popup_a_interval = 60000;
var initial_URL = window.location.href;
var idle_help_reminder = 30000;
var popup_a_status = true;

function alertbox (){
	var time_created = new Date();
	woopra.track("popup_A", {
			    timestamp: time_created.toUTCString()
			});
	popup_a_status = false;
	swal({
	   title: "Meldung",   
	   text: "M\xF6chten Sie in der Brosch\xFCre weiterlesen oder bereits jetzt mit dem Fragebogen fortfahren? \n\nSie werden nach einer Minute erneut die M\xF6glichkeit erhalten mit dem Fragebogen fortzufahren oder in der Brosch\xFCre weiter zu bl\xE4ttern.",
	   imageUrl: "../images/alarm.jpg",   
	   showCancelButton: true,   
	   confirmButtonColor: "#DD6B55",   
	   confirmButtonText: "Fragebogen fortf\xFChren",   
	   cancelButtonText: "Brosch\xFCre weiterlesen",   
	   closeOnConfirm: false,   
	   closeOnCancel: true,
	   allowEscapeKey: false
	}, 
	   function(isConfirm){   
	   	if (isConfirm) {     
	   		window.location.replace("https://mingle.respondi.com/s/600167/ospe.php3?return_tic="+user_id+"");
	   		var time_now = new Date();
			woopra.track("goto_survey", {
			    timestamp: time_now.toUTCString(),
			    elapsed_time_s: ((time_now - time_created)/1000) // s - survey
			});
	   	} else {
	   		var time_now = new Date();
			woopra.track("need_time", {
			    timestamp: time_now.toUTCString(),
			    elapsed_time_b: ((time_now - time_created)/1000) // b - brochure
			});
	   		//popup_a_interval = (popup_a_interval/2);
	   		setTimeout(function(){
	   			alertbox();
	   			}, popup_a_interval);
	   	} 
	   });
}

// Idle alert
/* Encoding Table
ä	\xE4
ë	\xEB
ö	\xF6
ü	\xFC
Ä	\xC4
Ë	\xCB
Ö	\xD6
Ü	\xDC
ß	\xDF	*/
function idleAlert() {
	var current_URL = window.location.href;
	if (initial_URL == current_URL) {
		Clock.pause();
        clock_active = false;
        var time_pause = new Date();
	   		woopra.track("pause", {
			    timestamp: time_pause.toUTCString()
			});
		swal({
			title: "Hilfe",
	   		text: "Sie k\xF6nnen in der Brosch\xFCre bl\xE4ttern, indem Sie mit der Maus den oberen oder unteren rechten Rand der Seite anklicken. Oder Sie f\xFChren mit gedr\xFCckter Maustaste eine Bl\xE4tterbewegung durch. Ihnen ist es m\xF6glich jederzeit vor- und auch wieder zur\xFCck zu bl\xE4ttern.",
	   		imageUrl: "../images/help.png",
	   		allowEscapeKey: false
	   	}, function (){
	   		Clock.resume();
	   		clock_active = true;
	   		var time_resume = new Date();
	   		woopra.track("resume", {
			    timestamp: time_resume.toUTCString(),
			    elapsed_time: ((time_resume - time_pause)/1000)
			});
		});

	} else {}
}


setInterval(function(){
	var active_time = Clock.totalSeconds;
	if (lastPage && popup_a_status && active_time >= 120 && idleTime >=10) {
    	popup_a_status = false;
    	alertbox();
  	}else if (popup_a_status && active_time >=240 && idleTime >=10) {
  		popup_a_status = false;
  		alertbox();
  	} else if (popup_a_status && active_time >=360) {
  		popup_a_status = false;
  		alertbox();

  	} else {}

}, 3000);



/*
//popup_A to redirect users
setTimeout(function(){
	//alertbox();
	if (lastPage)
	{
		alertbox();
	}
	else{
		delay();
	}
	
}, popup_a_interval); 


//delay function
var delayTime = 0;
function delay() {
		setTimeout(function(){
		alertbox();
		delayTime =0; //delay reset
	}, delayTime); 
}  */

// to assist users with the UI (help popup)
setTimeout(function(){
	idleAlert();
}, idle_help_reminder);


//Tracking the idle time
var idleTime = 0;
$(document).ready(function () {
    //Increment the idle time counter every minute.
    var idleInterval = setInterval(timerIncrement, 5000); // 10 seconds

    //Zero the idle timer on mouse movement.
    $(this).mousemove(function (e) {
        idleTime = 0;
        idleTime_clone = 0;
        
    });
    $(this).keydown(function (e) {
        idleTime = 0;
        idleTime_clone = 0;

    });
    $(this).on("tap", function (e) {
        idleTime = 0;
        idleTime_clone = 0;
    });
});

var popup_count =0;
var clock_active = true;
var current_idleTime = 0; //to track reading time
var idleTime_clone = 0; //to track reading time

//to calculate reading time
setInterval(function(){
	if (idleTime_clone >=10) {
		current_idleTime = current_idleTime+idleTime_clone;
		idleTime_clone =0;
	};	
},11000);


function timerIncrement() {
    idleTime = idleTime + 5000;
    idleTime_clone = idleTime_clone +5000;

    if (idleTime >= 80000 && popup_a_status &&clock_active) { // 40 seconds
        //delayTime = (delayTime + idleTime);
        Clock.pause();
        clock_active = false;
        var time_pause = new Date();
	   		woopra.track("pause", {
			    timestamp: time_pause.toUTCString()
			});
        swal({
			title: "Hilfe!",
	   		text: "Sie k\xF6nnen in der Brosch\xFCre bl\xE4ttern, indem Sie mit der Maus den oberen oder unteren rechten Rand der Seite anklicken. Oder Sie f\xFChren mit gedr\xFCckter Maustaste eine Bl\xE4tterbewegung durch. Ihnen ist es m\xF6glich jederzeit vor- und auch wieder zur\xFCck zu bl\xE4ttern.",
	   		imageUrl: "../images/help.png",
	   		allowEscapeKey: false
	   	}, function () {
	   		Clock.resume();
	   		clock_active = true;
	   		var time_resume = new Date();
	   		woopra.track("resume", {
			    timestamp: time_resume.toUTCString(),
			    elapsed_time: ((time_resume - time_pause)/1000)
			});
		});
        idleTime =0;
        
        };
    }

//----------------------------------
var Clock = {
  totalSeconds: 0,

  start: function () {
    var self = this;

    this.interval = setInterval(function () {
      self.totalSeconds += 1;

      $("#hour").text(Math.floor(self.totalSeconds / 3600));
      $("#min").text(Math.floor(self.totalSeconds / 60 % 60));
      $("#sec").text(parseInt(self.totalSeconds % 60));
    }, 1000);
  },

  pause: function () {
    clearInterval(this.interval);
    delete this.interval;
  },

  resume: function () {
    if (!this.interval) this.start();
  }
};

Clock.start();


</script> 


<script>
//google analytics
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-63498438-1', 'auto');
  ga('send', 'pageview');

</script>




</body>
</html>